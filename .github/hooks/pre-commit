#!/bin/bash

commit_msg_file=$(git rev-parse --git-dir)/COMMIT_EDITMSG
commit_msg=$(cat "$commit_msg_file")

commit_msg=$(echo "$commit_msg" | sed -e '/^#/d' -e '/^$/d')

if [ -z "$commit_msg" ]; then
    echo "Error: Commit message cannot be empty"
    exit 1
fi

if ! echo "$commit_msg" | grep -qE '^(feat|fix|docs|style|refactor|test|chore)(\([a-z]+\))?: .+'; then
    echo "Error: Commit message must follow the conventional commit format"
    echo "Example: feat(backend): add user authentication"
    exit 1
fi

exit 0
